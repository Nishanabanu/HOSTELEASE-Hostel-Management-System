{% extends "warden/base.html" %}
{% load static %}
{% block title %}
Warden | Add Room
{% endblock title %}

{% block body %}
<div class="container mt-5">
    <h2 class="text-center mb-4">Add New Room</h2>
    <div class="row justify-content-center">
        <div class="col-md-6">
            <form method="POST" action="" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="form-group mb-3">
                    <label for="room_number">Room Number</label>
                    <input type="text" class="form-control" id="room_number" name="room_number" placeholder="Enter room number" required>
                </div>
                <div class="form-group mb-3">
                    <label for="capacity">Capacity</label>
                    <input type="number" class="form-control" id="capacity" name="capacity" placeholder="Enter room capacity" required>
                </div>
                <div class="form-group mb-4">
                    <label for="image">Room Image</label>
                    <input type="file" id="image" name="image" accept=".jpg, .jpeg, .png" required style="width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px;">
                    <small id="image_error" class="text-danger" style="display:none;">Only JPG, JPEG, or PNG files are allowed.</small>
                                </div>
                <div class="text-center">
                    <button type="submit" class="btn btn-primary">Add Room</button>
                    <a href="{% url 'warden_view_rooms' %}" class="btn btn-secondary ml-3">Cancel</a>
                </div>
            </form>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function() {
        // Image validation for file type
        $('#image').on('change', function() {
            var file = $(this).val();
            var allowedExtensions = /(\.jpg|\.jpeg|\.png)$/i;  // Allow jpg, jpeg, png

            if (!allowedExtensions.exec(file)) {
                $('#image_error').show();  // Show error if invalid
                $(this).val('');  // Clear the file input
            } else {
                $('#image_error').hide();  // Hide error if valid
            }
        });

        // Form submission validation (optional redundancy)
        $('form').on('submit', function(e) {
            var file = $('#image').val();
            var allowedExtensions = /(\.jpg|\.jpeg|\.png)$/i;

            if (!allowedExtensions.exec(file)) {
                e.preventDefault();  // Prevent form submission if invalid
                $('#image_error').show();
            }
        });
    });
</script>
{% endblock body %}
