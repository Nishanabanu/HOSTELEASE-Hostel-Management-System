{% extends "warden/base.html" %}
{% load static %}
{% block title %}
Warden | Student Complete History
{% endblock title %}
{% block name %}{{ student.name }}{% endblock name %}
{% block body %}
<div class="container mt-4">
    <h2 class="text-center">Complete History of {{ student.name }}</h2>

    {% if error %}
        <div class="alert alert-danger text-center" role="alert">
            {{ error }}
        </div>
    {% else %}
        <div class="row">
            <!-- Student Information Card -->
            <div class="col-md-4 mb-4">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h5 class="card-title">Student Information</h5>
                    </div>
                    <div class="card-body">
                        <p><strong>Name:</strong> {{ student.name }}</p>
                        <p><strong>Admission Number:</strong> {{ student.admission_number }}</p>
                        <p><strong>Course:</strong> {{ student.COURSE.course_name }}</p>
                        <p><strong>Year:</strong> {{ student.year }}</p>
                        <p><strong>Joined On:</strong> {{ student.date_of_joining }}</p>
                    </div>
                </div>
            </div>

            <!-- Parent Information Card -->
            <div class="col-md-4 mb-4">
                <div class="card">
                    <div class="card-header bg-info text-white">
                        <h5 class="card-title">Parent Information</h5>
                    </div>
                    <div class="card-body">
                        <p><strong>Name:</strong> {{ parent.name }}</p>
                        <p><strong>Phone Number:</strong> {{ parent.phone_number }}</p>
                    </div>
                </div>
            </div>

            <!-- Tutor Information Card -->
            <div class="col-md-4 mb-4">
                <div class="card">
                    <div class="card-header bg-success text-white">
                        <h5 class="card-title">Tutor Information</h5>
                    </div>
                    <div class="card-body">
                        {% if tutor %}
                            <p><strong>Name:</strong> {{ tutor.name }}</p>
                            <p><strong>Phone Number:</strong> {{ tutor.phone_number }}</p>
                        {% else %}
                            <p>No tutor assigned.</p>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

        <!-- Room and Hostel Information Card -->
        <div class="row">
            <div class="col-md-6 mb-4">
                <div class="card">
                    <div class="card-header bg-warning text-white">
                        <h5 class="card-title">Room Information</h5>
                    </div>
                    <div class="card-body">
                        {% if room %}
                            <p><strong>Room Number:</strong> {{ room.room_number }}</p>
                            {% if hostel %}
                                <p><strong>Hostel:</strong> {{ hostel.name }}</p>
                                <p><strong>Hostel Details:</strong> {{ hostel.details }}</p>
                            {% else %}
                                <p>No hostel assigned.</p>
                            {% endif %}
                        {% else %}
                            <p>No room assigned to this student.</p>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- Total Leaves Card -->
            <div class="col-md-6 mb-4">
                <div class="card">
                    <div class="card-header bg-light">
                        <h5 class="card-title">Total Leaves</h5>
                    </div>
                    <div class="card-body">
                        <p><strong>Total Leaves Taken:</strong> {{ total_leaves }}</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Payments History Card -->
        <div class="row">
            <div class="col-12">
                <div class="card mb-4">
                    <div class="card-header bg-secondary text-white">
                        <h5 class="card-title">Payment History</h5>
                    </div>
                    <div class="card-body">
                        {% if payments %}
                            <ul class="list-group">
                                {% for payment in payments %}
                                    <li class="list-group-item">
                                        <strong>Amount:</strong> â‚¹{{ payment.amount }} <br>
                                        <strong>Status:</strong> {{ payment.status }} <br>
                                        <strong>Date:</strong> {{ payment.date }} <br>
                                        {% if payment.screenshot %}
                                            <strong>Screenshot:</strong><br>
                                            <img src="{{ payment.screenshot.url }}" alt="Payment Screenshot" class="img-fluid" style="max-width: 100%;">
                                        {% endif %}
                                    </li>
                                {% endfor %}
                            </ul>
                        {% else %}
                            <p>No payment records found.</p>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    {% endif %}
</div>
{% endblock body %}
